<!-- template for the masonry wall of images -->
<script id="templateImages" type="x-tmpl-mustache">
    <h3>{{recordsFound}} records found. {{from}} to {{to}} shown below.</h3>
    
    <div id="masonry" class="masonry">
        {{#figures}}
        <figure class="item">
            <a href="#carousel" class="carousel"><img src="{{imgBlur}}" width="250" data-src="{{imgA}}" class="lazyload" data-recid="{{recId}}"></a>
            
            <figcaption class="transition-050 opacity85 text">
                <a class="transition-050">rec ID: {{recId}}</a>
                <div class="transition-050 desc">{{title}}. <a href='{{zenodoRecord}}' target='_blank'>more</a></div>
            </figcaption>
        </figure>
        {{/figures}}
    </div>
    
    {{#pager}}
    <div id="pager">
        {{#prev}}◀ <a href="{{prev}}" id="prev" class="pager">prev</a>{{/prev}}
        {{#next}}<a href="{{next}}" id="next" class="pager">next</a> ▶{{/next}}
    </div>
    {{/pager}}
</script>

<!-- template for the vertical carousel -->
<script id="templateCarousel" type="x-tmpl-mustache"> 
    {{#figures}}
    <figure id="{{recId}}" class="image-wrapper">
        <div class="carouselOff">x</div>
        <a href="{{imageSrc}}" target="_blank">
            <img src="{{imgA}}" data-src="{{imgC}}"  class="lazyload" alt="{{title}}" data-recid="{{recId}}"></a>
        <figcaption>
            <a class="transition-050">rec ID: {{recId}}</a>
            <div class="transition-050 desc">{{title}}. <a href='{{zenodoRecord}}' target='_blank'>more</a></div>
        </figcaption>
    </figure>
    {{/figures}}
</script>

<!-- template for fulltext search of treatments -->
<script id="templateTreatments" type="x-tmpl-mustache">
    <h3>{{recordsFound}} records found. {{from}} to {{to}} shown below.</h3>

    {{#treatments}}
    <details open>
        <summary>{{treatmentTitle}}</summary>
        
        <!--
        <div class='masonry'>
            {{#images}}
            <a href="#carousel" class="carousel"><img src="{{thumb50}}" width="50" alt="{{imageTitle}}"></a> 
            {{/images}}
        </div>
        -->

        <p>{{{s}}} <a class="treatmentLink" href="/index.html?resource=treatments&treatmentId={{treatmentId}}">more</a></p>
    </details>
    {{/treatments}}

    {{#pager}}
    <div id="pager">
        {{#prev}}◀ <a href="{{prev}}" id="prev" class="pager">prev</a>{{/prev}}
        {{#next}}<a href="{{next}}" id="next" class="pager">next</a> ▶{{/next}}
    </div>
    {{/pager}}
</script>

<!-- template for a single treatment -->
<script id="templateTreatment" type="x-tmpl-mustache">
    <div class="treatment">
        <div id="treatmentInfo">
            <p class="summary">{{treatmentTitle}}</p>
            <ul class="pids">
                <li class="treatmentId">Treatment ID: <a href="{{zenodeo}}/v2/treatments?treatmentId={{treatmentId}}&format=xml" target="_blank">{{treatmentId}}</a> <span class="xml-marker">&lt;xml&gt;</span></li>
                <li class="doi">DOI: <a href="{{doi}}" target="_blank">{{doi}}</a></li>
                <li class="zenodoDep">Zenodo deposit: <a href="https://www.zenodo.org/record/{{zenodoDep}}" target="_blank">{{zenodoDep}}</a></li>
            </ul>
            
            <p class="journal">{{authorsList}}. {{journalYear}}. {{articleTitle}}. <i>{{journalTitle}}</i>, Vol. {{journalVolume}}, Issue {{journalIssue}}, pages {{pages}}</p>
        </div>

        <ul class="classification">
            {{#taxonStats}}
            <li class="kingdom">
                <div class="txn">
                    <a class="treatmentLink" href="/index.html?resource=treatments&kingdom={{kingdom.qryObj.kingdom}}">{{kingdom.qryObj.kingdom}}</a> [{{kingdom.num.num}}]
                </div>
            </li>
            <li class="phylum">
                <div class="txn">
                    <a class="treatmentLink" href="/index.html?resource=treatments&kingdom={{phylum.qryObj.kingdom}}&phylum={{phylum.qryObj.phylum}}">{{phylum.qryObj.phylum}}</a> [{{phylum.num.num}}]
                </div>
            </li>
            <li class="order">
                <div class="txn">
                    <a class="treatmentLink" href="/index.html?resource=treatments&kingdom={{order.qryObj.kingdom}}&phylum={{order.qryObj.phylum}}&order={{order.qryObj.order}}">{{order.qryObj.order}}</a> [{{order.num.num}}]
                </div>
            </li>
            <li class="family">
                <div class="txn">
                    <a class="treatmentLink" href="/index.html?resource=treatments&kingdom={{family.qryObj.kingdom}}&phylum={{family.qryObj.phylum}}&order={{family.qryObj.order}}&family={{family.qryObj.family}}">{{family.qryObj.family}}</a> [{{family.num.num}}]
                </div>
            </li>
            <li class="genus">
                <div class="txn">
                    <a class="treatmentLink" href="/index.html?resource=treatments&kingdom={{genus.qryObj.kingdom}}&phylum={{genus.qryObj.phylum}}&order={{genus.qryObj.order}}&family={{genus.qryObj.family}}&genus={{genus.qryObj.genus}}">{{genus.qryObj.genus}}</a> [{{genus.num.num}}]
                </div>
            </li>
            <li class="species">
                <div class="txn">
                    <a class="treatmentLink" href="/index.html?resource=treatments&kingdom={{species.qryObj.kingdom}}&phylum={{species.qryObj.phylum}}&order={{species.qryObj.order}}&family={{species.qryObj.family}}&genus={{species.qryObj.genus}}&species={{species.qryObj.species}}">{{species.qryObj.species}}</a> [{{species.num.num}}]
                </div>
            </li>
            {{/taxonStats}}
        </ul>

        <details class="treatment" {{mapState}}>
            <summary>Map</summary>
            <div id="map"></div>
        </details>

        <details class="treatment">
            <summary>Figures</summary>
            <div id="masonry" class="masonry">
                {{#figures}}
                <figure class='item'>
                    <a href="#carousel" class="carousel"><img src="{{imgBlur}}" width="250" data-src="{{imgA}}" class="lazyload" data-recid="{{recId}}"></a>
                    
                    <figcaption class="transition-050 opacity85 text">
                        <a class="transition-050">rec ID: {{recId}}</a>
                        <div class="transition-050 desc">{{title}}. <a href='{{zenodoRecord}}' target='_blank'>more</a></div>
                    </figcaption>
                </figure>
                {{/figures}}
            </div>
        </details>

        <details class="treatment">
            <summary>Citations</summary>
            <ul class="citations">
                {{#citations}}
                <li>{{citation}}</li>
                {{/citations}}
            </ul>
        </details>

        <details class="treatment">
            <summary>Treatment Text</summary>
            <p class="xml">{{{xml}}}</p>
        </details>
    </div>
</script>